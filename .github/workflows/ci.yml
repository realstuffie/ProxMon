name: CI

on:
  push:
    branches: ["**"]
  pull_request:

jobs:
  build-linux:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout (with submodules)
        uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Install build dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y --no-install-recommends \
            cmake ninja-build g++ pkg-config \
            qt6-base-dev qt6-declarative-dev qt6-base-dev-tools qt6-tools-dev-tools \
            libqt6svg6-dev \
            extra-cmake-modules \
            libkf6coreaddons-dev libkf6i18n-dev libkf6notifications-dev libkf6config-dev

      - name: Configure (CMake)
        run: |
          cmake -S contents/lib -B contents/lib/build-ci -G Ninja \
            -DCMAKE_BUILD_TYPE=Release

      - name: Build
        run: |
          cmake --build contents/lib/build-ci

      - name: QML syntax check (best-effort)
        continue-on-error: true
        run: |
          if command -v qmllint >/dev/null 2>&1; then
            qmllint contents/ui/*.qml
          else
            echo "qmllint not available on runner"
          fi
